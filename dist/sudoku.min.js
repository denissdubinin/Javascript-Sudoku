/*! Javascript Sudoku v1.0.0 by Deniss Dubinin - https://github.com/denissdubinin/Javascript-Sudoku - Licensed MIT */

"use strict";window.sudoku={Valve:"Trilogy"},function(window,$){$.fn.Sudoku=function(options){var defaults={defaultSquare:3,dropTimerOnReset:!0,markWrongCellsOnFly:!1,markWrongCellsOnFinish:!0,useTimer:!0,timerOnly:!0,sudokuMixIterations:500},options=$.extend({},defaults,options),sudokuTimer;function create(o){generateGui(o),init()}function init(){toggleLoadingOverlay(!0),generateMatrix(),mixMatrix(),prepareEmptyMatrix(),fillGrid()}function generateGui(o){o.prepend('<label id="sudoku-minutes">00</label>:<label id="sudoku-seconds">00</label>'),$('<table class="table table-bordered"></table>').appendTo(o);for(var t=0,u=0;t<9;){for(var n=$('<tr class="sudoku-row"></tr>').appendTo(o.find("table"));u<9;)$('<td class="sudoku-cell"><input size="1" maxlength="1" onkeypress="return window.sudoku.listenKeyPress(event);"></td>').appendTo(n),u++;u=0,t++}initGridButtons(o)}function checkSudokuSuccess(){if(!$(".sudoku-cell").find("input").filter(function(){return""===this.value}).length){var o=[];$(".sudoku .sudoku-row").each(function(t){o.push([]),$(this).find("input").each(function(){o[t].push(parseInt($(this).val()))})}),checkResults(o,window.sudoku.fullMatrix)&&$(document).trigger("startConfetti")}}function toggleLoadingOverlay(o){o?$(".sudoku").addClass("loading"):$(".sudoku").removeClass("loading")}function initGridButtons(o){var t=$("<div>").addClass("btn-group"),u=$("<button>").addClass("btn btn-success btn-sm").attr("id","start-sudoku").text("Start"),n=$("<button>").addClass("btn btn-danger btn-sm").attr("id","r-sudoku").text("Reset sudoku"),e=$("<button>").addClass("btn btn-primary btn-sm").attr("id","gn-sudoku").text("Generate new sudoku");t.append(u).append(n).append(e),o.append(t),$("#start-sudoku").on("click",function(){initTimer(),$("#start-sudoku").prop("disabled",!0)}),$("#r-sudoku").on("click",function(){1==confirm("Are you sure?")&&(fillGrid(),$(".sudoku-cell").removeClass("invalid-cell"),options.dropTimerOnReset&&resetTimer(!1))}),$("#gn-sudoku").on("click",function(){1==confirm("Are you sure?")&&($(document).trigger("stopConfetti"),$(".sudoku-cell input:disabled").prop("disabled",!1),$("#start-sudoku").prop("disabled",!1),$(".sudoku-cell").removeClass("invalid-cell"),resetTimer(!0),init())})}function initTimer(){var o=$("#sudoku-minutes"),t=$("#sudoku-seconds"),u=0;function n(o){var t=o+"";return t.length<2?"0"+t:t}sudokuTimer=setInterval(function(){++u,t.text(n(u%60)),o.text(n(parseInt(u/60)))},1e3)}function resetTimer(o){$("#sudoku-minutes, #sudoku-seconds").text("00"),clearInterval(sudokuTimer),o?$("#start-sudoku").prop("disabled",!1):initTimer()}function stopTimer(){clearInterval(sudokuTimer)}function generateMatrix(){var o=options.defaultSquare,t=[];for(let e=0;e<9;e++){var u=[];for(let t=0;t<9;t++){var n=(e*o+e/o+t)%(o*o)+1;u.push(parseInt(n))}t.push(u)}window.sudoku.fullMatrix=t}function fillGrid(){$(".sudoku-row").each(function(o){$(this).find("td").each(function(t){var u=window.sudoku.emptyMatrix[o][t],n=$(this).find("input");n.val(u),""!==u&&n.prop("disabled",!0)})}),toggleLoadingOverlay(!1),$(".sudoku-cell input").off("input"),$(".sudoku-cell input").on("input",function(){checkSudokuSuccess()})}function transposeMatrix(){return window.sudoku.fullMatrix=window.sudoku.fullMatrix[0].map(function(o,t){return window.sudoku.fullMatrix.map(function(o){return o[t]})}),window.sudoku.fullMatrix}function swapTwoRows(){for(var o=Math.floor(Math.random()*options.defaultSquare),t=Math.floor(Math.random()*options.defaultSquare),u=Math.floor(Math.random()*options.defaultSquare),n=o*options.defaultSquare+t;t==u;)u=Math.floor(Math.random()*options.defaultSquare);var e=o*options.defaultSquare+u,a=window.sudoku.fullMatrix[n],i=window.sudoku.fullMatrix[e];return window.sudoku.fullMatrix[n]=i,window.sudoku.fullMatrix[e]=a,window.sudoku.fullMatrix}function swapTwoColumns(){transposeMatrix(),swapTwoRows(),transposeMatrix()}function swapTwoLargeRows(){for(var o=Math.floor(Math.random()*options.defaultSquare),t=Math.floor(Math.random()*options.defaultSquare);o==t;)t=Math.floor(Math.random()*options.defaultSquare);for(let i=0;i<options.defaultSquare;i++){var u=o*options.defaultSquare+i,n=t*options.defaultSquare+i,e=window.sudoku.fullMatrix[u],a=window.sudoku.fullMatrix[n];window.sudoku.fullMatrix[u]=a,window.sudoku.fullMatrix[n]=e}return window.sudoku.fullMatrix}function swapTwoLargeColumns(){transposeMatrix(),swapTwoLargeRows(),transposeMatrix()}function mixMatrix(){var t0=performance.now(),logicFunctions=["transposeMatrix()","swapTwoRows()","swapTwoRows()","swapTwoColumns()","swapTwoColumns()","swapTwoLargeRows()","swapTwoLargeColumns()"];let i=0;for(;i<options.sudokuMixIterations;){var randomFunction=Math.floor(Math.random()*logicFunctions.length);eval(logicFunctions[randomFunction]),i++}var t1=performance.now();window.sudoku.generationTime=(.001*(t1-t0)).toFixed(5)+" seconds."}function prepareEmptyMatrix(){window.sudoku.emptyMatrix=[];for(let o=0;o<options.defaultSquare*options.defaultSquare;o++){window.sudoku.emptyMatrix.push([]);for(let t=0;t<options.defaultSquare*options.defaultSquare;t++)window.sudoku.emptyMatrix[o].push("")}let o=0;for(;o<options.defaultSquare**4;){let t=Math.floor(Math.random()*options.defaultSquare**2),u=Math.floor(Math.random()*options.defaultSquare**2);""===window.sudoku.emptyMatrix[t][u]&&(o++,10*Math.random()>6&&(window.sudoku.emptyMatrix[t][u]=window.sudoku.fullMatrix[t][u]))}}function checkResults(o,t){let u=!1;for(let e=0;e<o.length;e++)for(let a=0;a<o.length;a++){var n=$(`.sudoku-row:eq(${e}) .sudoku-cell:eq(${a})`);o[e][a]!==t[e][a]?(u=!0,options.markWrongCellsOnFinish&&n.addClass("invalid-cell")):n.removeClass("invalid-cell")}return!u}create($(this)),window.sudoku.listenKeyPress=function(o){var t=window.event?o.keyCode:o.which;return 8==o.keyCode||46==o.keyCode||t>47&&t<58}}}(window,jQuery);